[开源地址](https://github.com/innc11/updater-server)
[mcbbs发布贴地址](http://www.mcbbs.net/forum.php?mod=viewthread&tid=711833)
[百度网盘下载地址](https://pan.baidu.com/s/1d3TtyY)

文档版本：**1.0**

## 配置文件的说明

#### 配置文件载入的说明

配置文件的载入方式分2种，**内部载入**和**外部载入**

**内部载入**是指配置文件写在程序内部，不容易被误删，但修改步骤较为繁琐，内联配置文件一般在程序jar包里，把程序用压缩软件打开即可看见

**外部载入**是指配置文件写在程序外部，一般在程序所在目录里，及和程序文件放在一起，修改较为方便，但容易被误删

**外部载入** 的优先级**高于** **内部载入**，当外部配置文件存在时，程序只会读取外部配置文件，不会读取内部配置文件，当外部配置文件不存在时，才会读取内部配置文件。

**外部配置文件可以不存在，但内部配置文件不能被删掉**

#### 配置文件的说明

服务端配置文件不能像客户端一样使用内部载入，只能使用外部载入

服务端有2个配置文件，分别是serverConfig.properties和rulesConfig.properties

serverConfig.properties文件用于配置程序的工作参数

rulesConfig.properties文件用于配置文件的更新规则

#### 配置文件的位置

配置文件默认存在于程序jar包中，默认不需要创建。

#### 外部配置文件的位置和创建

外部配置文件不会自动生成，需要手动创建，用压缩软件打开程序jar包，找到**serverConfig.properties**和**rulesConfig.properties**，提取到和程序jar包相同的目录下，即在程序jar包的旁边，已确保能程序能正确读取，即完成外部配置文件的创建。（外部配置文件的创建也就是把内部配置文件复制到程序jar包的旁边）

#### 配置文件的修改

###### serverConfig.properties文件的修改

使用文本编辑器打开配置文件，默认的模板为

```
port=5398
maxDownstreamSpeed=500
maxOnlineClient=4
```

其中有3个可设置项，分别是port，maxDownstreamSpeed，maxOnlineClient。对应说明如下：
* port => 服务端监听的端口，只要不和其它程序发生冲突就可
* maxDownstreamSpeed => 最大的下行速度，也就是文件下载限速，单位为Kb/s
* maxOnlineClient => 同一时间最大的连接上的客户端数量，建议设置成2-4，建议不要超过12

修改完后保存

###### serverConfig.properties文件的修改

serverConfig.properties文件推荐用附带的**规则配置小工具**来修改

打开**规则配置小工具**，点击加载，选择**rulesConfig.properties**并打开，可以点击添加规则，输入规则名字（这个名字随意，不会有任何影响，支持中文）后，双击创建的规则，打开编辑面板，在面板下方输入**客户端路径**和**服务端路径**，（客户端路径：例子 .minecraft/mods）（服务端路径：例子 clientmods）此处路径必须使用标准的相对路径，请不要在开头加上  . 符号，此处的**忽略的文件列表**也一样必须使用标准的相对路径（虽然 ./aabbcc和aabbcc填在这里是指向的同一个文件夹，但是尽量使用后者的格式，后者就是标准的格式，如果使用前者可能会导致忽略问文件的功能失效），在**忽略的文件列表**中的文件在同步时将被忽略掉，也就是不会删除和修改，常用来保护一些数据文件夹。修改完成后点击确定，然后保存回**原文件**，也就是serverConfig.properties文件

## 程序的启动

1.2.1版本只保留了命令行启动 ```java -jar updater-server.jar``` 即可

## 动态更新

1.2.1版本无需手动配置此项

## 更新日志

##### 0.1
1. 第一个版本发布

##### 0.2
1. 修复Java7无法运行的问题

##### 0.3
1. 修复了误删小地图、输入补丁的问题

##### 1.0
1. 修复了Mods文件夹中有文件夹会报错的情况，现在会自动跳过文件夹
2. 修改通信协议，默认端口更换为28445
3. 增加日志功能
4. 添加后台日志的显示开关
5. 移除限速功能
6. 添加简易文件白名单功能
7. 添加双击打开服务端文件错误信息的提示
8. 添加白名单的路径设置
9. 添加配置文件可以直接使用默认配置的功能
10. 修复服务端程序可能会被恶意关闭的问题

##### 1.0.1b1
1. 添加对文件夹的支持
2. 添加对多个文件夹的支持
3. 添加对文件的比较（MD5）
4. 添加对多个更新源的支持
5. 添加限速功能
6. 精简配置文件
7. 修改部分日志输出为中文
8. 添加[规则]机制
9. 修改默认端口为22123

##### 1.0.1b2
1. 修复文件极多的文件夹无法更新的问题
2. 修改默认端口为26542
3. 移除控制台调试信息

##### 1.1
1. 添加带有GUI界面的小工具来方便的配置规则
2. 添加动态执行机制
3. 添加文件忽略机制
4. 添加对命令行启动的支持
5. 修改默认端口为5398
6. 修改JRE最低要求为1.8或者更高版本
7. 添加内置的帮助文档

##### 1.2
1. 添加部分源代码的JavaDoc
2. 为找不到客户端jar添加错误提示信息
3. 为找不到更新文件夹添加错误提示信息
4. 修复多余的mod不会删除的bug
5. 修复忽略文件的功能bug

##### 1.2.1
1. 去除托盘UI的启动方式
2. 客户端核心JAR开始内置，不再需要单独配置，serverConfig.properties中以及移除此选项
3. 优化代码逻辑